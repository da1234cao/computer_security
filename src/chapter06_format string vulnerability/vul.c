/**
 * vol.c
 * 编译：gcc -g -o vol vol.c
 * 
 * 使用：直接修改返回地址
 * 
 * 尝试知：经过５次%x,可以跳转到input
 * 
 * 已知：var的地址是0xbffecb4
 * 经过调试计算
 * input的地址是：0xbffecb8 = 0xbffecb4+4
 * ebp指向的地址是：0xbffecb8 + 0x70 = 0xbffecb4 + 4 + 0x70
 * eip的地址是：0xbffecb4 + 4 + 0x70 + 4 = 0xBFFED2C
*/

#include <stdio.h>


void fmtstr(void){
    char input[10]={0};
    int var = 0x11223344;

    printf("The value of var: %d\n ",var);
    printf("The address of var: 0x%lx\n ", &var);

    fgets(input,sizeof(input)-1,stdin);
    printf(input);
    printf("%s",input);
}

int main(void){
    fmtstr();
    return 0;
}